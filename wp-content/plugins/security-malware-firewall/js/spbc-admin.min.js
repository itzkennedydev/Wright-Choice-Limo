function spbcGetGoogleQrCode(){var e={};let t={};return e.security=spbcSettings.ajax_nonce,e.action="spbc_get_google_qr_code",jQuery.ajax({type:"POST",async:!1,url:spbcSettings.ajaxurl,data:e,success:function(e){t=e}}),t}function spbcCheckGoogleCode(){var e={};e.security=spbcSettings.ajax_nonce,e.action="spbc_check_google_code",e.code=jQuery("#spbct-google-qr-code input").val(),jQuery.ajax({type:"POST",async:!1,url:spbcSettings.ajaxurl,data:e,success:function(e){var t;e.success?(jQuery("#spbct-google-qr-code").dialog("close"),0<(t=jQuery("form#your-profile input#submit")).length&&t.click()):alert(e.data)}})}function spbcDisableG2fa(e){var t={};t.security=spbcSettings.ajax_nonce,t.action="spbc_disable_google_2fa",t.user_id=jQuery(e).data("user-id"),jQuery.ajax({type:"POST",async:!1,url:spbcSettings.ajaxurl,data:t,success:function(e){e.success?document.location.reload():alert(e.data)}})}function spbcCheckVulnerability(e,t="install"){var c={};c.security=spbcSettings.ajax_nonce,c.action="install"===t?"spbc_check_vulnerability_install":"spbc_check_vulnerability_list",c.list=e,jQuery.ajax({type:"POST",async:!1,url:spbcSettings.ajaxurl,data:c,success:function(e){e.success?("install"===t&&spbcCheckVulnerabilityInstallRender(e.list,e.msg),"list"===t&&spbcCheckVulnerabilityListRender(e.list)):console.log(e)}})}function spbcCheckVulnerabilityListRender(e){let t,c;e.forEach(e=>{(c=document.createElement("div")).classList.add("notice","notice-error","error-message","spbc-vulnerable-notice"),c.innerHTML=e.msg,(t=document.querySelector(".themes .theme[data-slug="+e.slug+"]"))&&t.appendChild(c)})}function spbcCheckVulnerabilityInstallRender(e,t){let c,n=document.createElement("div");n.classList.add("notice"),n.innerHTML="<p>"+t+"</p>",e.forEach(e=>{(c=document.querySelector(".theme-id-container .theme-actions a[data-slug="+e+"]"))&&c.parentNode.parentNode.parentNode.appendChild(n)})}function spbcSummaryShowCDNCheckerTable(){event.preventDefault();var e=document.getElementById("spbc_stats_cdn_checker_table");void 0!==e&&("block"===e.style.display?e.style.display="none":e.style.display="block")}function spbcHandleBannersDismissing(){var e=jQuery("body");e.on("click",".spbct-notice-dismiss-link",function(e){jQuery(e.target).siblings(".notice-dismiss").click()}),e.on("click",".spbc-notice .notice-dismiss",function(n){var s,i,a=jQuery(n.target).parent(".notice").attr("id");if(a&&(spbcSendAJAXRequest({action:"spbc_dismiss_banner",banner_id:a},{}),"undefined"!=typeof spbcSettings)&&spbcSettings.hasOwnProperty("spbctNoticeDismissSuccess")){let e=spbcSettings.spbctNoticeDismissSuccess,t="",c="";if("string"==typeof e){try{e=JSON.parse(e)}catch(n){e=[]}for(var l of e)l.hasOwnProperty("bannerName")&&l.hasOwnProperty("postNoticeText")&&(s=l.bannerName,-1!==a.indexOf(s)&&(t=l.postNoticeText),l.hasOwnProperty("noticeLevel"))&&(c=l.noticeLevel)}""!==t&&(i='<div id="spbct-notice-dismiss-success" class="'+("notice "+c+" is-dismissible")+'"><p>'+t+"</p></div>",jQuery(n.target).parent(".notice").after(i),setTimeout(function(){jQuery("#spbct-notice-dismiss-success").fadeOut()},5e3))}})}function spbcHighlightCriticalFilesNotice(e=!1){var t=-1!==window.location.href.indexOf("spbc_tab=scanner&highlight_critical_files=1"),n=-1===window.location.href.indexOf("spbc_tab=scanner");if(e&&n)window.location.href="options-general.php?page=spbc&spbc_tab=scanner&highlight_critical_files=1";else if(t||e){let t=null;n=document.querySelectorAll("#notice_id_found_critical_files");if(0<n.length&&n.forEach(e=>{null==t&&null!==e.closest("#spbc_tab-scanner")&&(t=e)}),null!==t&&(t.scrollIntoView({behavior:"smooth",block:"start"}),!t.hasOwnProperty("highlighted"))){let e=!1;setInterval(()=>{(e=!e)?(t.classList.remove("notice-warning"),t.classList.add("notice-error"),t.highlighted=!0):(t.classList.remove("notice-error"),t.classList.add("notice-warning"))},1e3)}let c=document.querySelector('h3[aria-controls="spbc_scan_accordion_tab_critical"]');if(null!==c)c.classList.contains("ui-accordion-header-active")||c.click();else{let e=setInterval(()=>{null!==(c=document.querySelector('h3[aria-controls="spbc_scan_accordion_tab_critical"]'))&&(c.classList.contains("ui-accordion-header-active")||c.click(),clearInterval(e))},150)}}}jQuery(document).ready(function(){if(-1<window.location.href.indexOf("themes.php")&&spbcSettings.vulnerabilityShowList){let e=[],t=[],c,n;setInterval(function(){0<(c=document.querySelectorAll(".themes .theme[data-slug]")).length&&(t=[],c.forEach(function(e){n=e.querySelector("img").src?e.querySelector("img").src.match(/ver=([\d\.]+)/)[1]:null,t.push({slug:e.dataset.slug,version:n})})),JSON.stringify(t)!=JSON.stringify(e)&&spbcCheckVulnerability(e=t,"list")},500)}if(-1<window.location.href.indexOf("theme-install.php")&&spbcSettings.vulnerabilityShowInstall){let e=[],t=[],c;setInterval(function(){0<(c=document.querySelectorAll(".theme-id-container .theme-actions a[data-slug]")).length&&(t=[],c.forEach(function(e){t.push(e.dataset.slug)})),JSON.stringify(t)!=JSON.stringify(e)&&spbcCheckVulnerability(e=t)},500)}jQuery(".spbc_update_notice").on("click","button",function(){spbcSetCookie("spbc_update_banner_closed",1,2592e3)}),jQuery(document).on("click","#spbc-g2fa-enable",function(e){e.preventDefault();e=spbcGetGoogleQrCode();e.success?(jQuery("#spbct-google-qr-code-img").html(e.data.img+"<p>"+e.data.code+"</p>"),jQuery("#spbct-google-qr-code input").val(""),jQuery("#spbct-google-qr-code").dialog({modal:!0,title:"Google authenticator activation",buttons:{Cancel:function(){jQuery(this).dialog("close")},Ok:function(){spbcCheckGoogleCode()}},draggable:!1,resizable:!1})):alert(spbcGetGoogleQrCode.data)}),jQuery(document).on("click","#spbc-g2fa-disable",function(e){e.preventDefault(),confirm("Are you sure?")&&spbcDisableG2fa(this)});function e(e,t,c){setTimeout(function(){null!==e&&(jQuery(".spbc-admin_bar--user_counter").html(e.count),e.count<=3?(jQuery("#wp-admin-bar-spbc_admin_bar__online_admins").show(),jQuery(".spbc-admin_bar--online_admins").html(e.users.join(", "))):jQuery("#wp-admin-bar-spbc_admin_bar__online_admins").hide()),spbcSendAJAXRequest(t,c)},15e3)}var t,c,n;1==+spbcSettings.admin_bar__admins_online_counter&&e(null,{action:"spbc_get_authorized_admins"},{callback:e}),spbcHandleBannersDismissing(),1==+spbcSettings.needToWhitelist&&spbcSendAJAXRequest({action:"spbc_private_list_add"},{callback:null}),0<+spbcSettings.critical&&((t=document.createElement("div")).className="spbc_ring-container",t.style.top="0px",t.style.right="70px",(n=document.createElement("div")).className="spbc_ringring",(c=document.createElement("div")).className="spbc_circle",t.appendChild(n),t.appendChild(c),n=document.querySelector("#menu-settings"))&&n.appendChild(t),jQuery(document).on("keyup","#spbc_key",function(e){e.preventDefault();e=jQuery("#spbc_key").val();/^[a-zA-Z0-9]+$/.test(e)&&8<e.length?(jQuery("#spbc-key-manually-link").hide(),jQuery("#spbc_setting_get_key_auto").hide(),jQuery("#spbc_get_key_or_text").hide()):(jQuery("#spbc-key-manually-link").show(),jQuery("#spbc_setting_get_key_auto").show(),jQuery("#spbc_get_key_or_text").show())}),spbcSettings.wl_mode_enabled&&jQuery(".plugin-title strong").each(function(e,t){0<=jQuery(t).html().indexOf("Security by CleanTalk")&&jQuery(t).html(jQuery(t).html().replace("CleanTalk",spbcSettings.wl_company_name))})});
//# sourceMappingURL=spbc-admin.min.js.map
